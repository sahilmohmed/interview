"use strict";var G=Object.defineProperty;var er=Object.getOwnPropertyDescriptor;var rr=Object.getOwnPropertyNames;var sr=Object.prototype.hasOwnProperty;var or=(t,e)=>{for(var r in e)G(t,r,{get:e[r],enumerable:!0})},nr=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of rr(e))!sr.call(t,o)&&o!==r&&G(t,o,{get:()=>e[o],enumerable:!(s=er(e,o))||s.enumerable});return t};var ar=t=>nr(G({},"__esModule",{value:!0}),t);var ls={};or(ls,{ContentType:()=>_,LabelName:()=>c,LinkType:()=>A,Severity:()=>St,Stage:()=>ht,Status:()=>u,StatusByPriority:()=>yt,allureId:()=>Ht,attachment:()=>kt,attachmentPath:()=>wt,description:()=>Dt,descriptionHtml:()=>Pt,displayName:()=>Rt,epic:()=>jt,feature:()=>Nt,historyId:()=>_t,issue:()=>Lt,label:()=>g,labels:()=>Et,layer:()=>Vt,link:()=>w,links:()=>At,logStep:()=>It,owner:()=>Wt,parameter:()=>bt,parentSuite:()=>zt,severity:()=>Kt,step:()=>Ft,story:()=>Ut,subSuite:()=>Bt,suite:()=>Gt,tag:()=>$t,tags:()=>Yt,testCaseId:()=>Mt,tms:()=>Ot});module.exports=ar(ls);var u=function(t){return t.FAILED="failed",t.BROKEN="broken",t.PASSED="passed",t.SKIPPED="skipped",t}({}),yt=[u.FAILED,u.BROKEN,u.PASSED,u.SKIPPED],ht=function(t){return t.SCHEDULED="scheduled",t.RUNNING="running",t.FINISHED="finished",t.PENDING="pending",t.INTERRUPTED="interrupted",t}({}),c=function(t){return t.ALLURE_ID="ALLURE_ID",t.AS_ID="ALLURE_ID",t.SUITE="suite",t.PARENT_SUITE="parentSuite",t.SUB_SUITE="subSuite",t.EPIC="epic",t.FEATURE="feature",t.STORY="story",t.SEVERITY="severity",t.TAG="tag",t.OWNER="owner",t.LEAD="lead",t.HOST="host",t.THREAD="thread",t.TEST_METHOD="testMethod",t.TEST_CLASS="testClass",t.PACKAGE="package",t.FRAMEWORK="framework",t.LANGUAGE="language",t.LAYER="layer",t}({}),St=function(t){return t.BLOCKER="blocker",t.CRITICAL="critical",t.NORMAL="normal",t.MINOR="minor",t.TRIVIAL="trivial",t}({}),_=function(t){return t.TEXT="text/plain",t.XML="application/xml",t.HTML="text/html",t.CSV="text/csv",t.TSV="text/tab-separated-values",t.CSS="text/css",t.URI="text/uri-list",t.SVG="image/svg+xml",t.PNG="image/png",t.JSON="application/json",t.ZIP="application/zip",t.WEBM="video/webm",t.JPEG="image/jpeg",t.MP4="video/mp4",t.IMAGEDIFF="application/vnd.allure.image.diff",t}({}),A=function(t){return t.DEFAULT="link",t.ISSUE="issue",t.TMS="tms",t}({});function M(){M=function(a,n){return new r(a,void 0,n)};var t=RegExp.prototype,e=new WeakMap;function r(o,a,n){var p=RegExp(o,a);return e.set(p,n||e.get(o)),k(p,r.prototype)}function s(o,a){var n=e.get(a);return Object.keys(n).reduce(function(p,i){var y=n[i];if(typeof y=="number")p[i]=o[y];else{for(var S=0;o[y[S]]===void 0&&S+1<y.length;)S++;p[i]=o[y[S]]}return p},Object.create(null))}return ir(r,RegExp),r.prototype.exec=function(o){var a=t.exec.call(this,o);if(a){a.groups=s(a,this);var n=a.indices;n&&(n.groups=s(n,this))}return a},r.prototype[Symbol.replace]=function(o,a){if(typeof a=="string"){var n=e.get(this);return t[Symbol.replace].call(this,o,a.replace(/\$<([^>]+)>/g,function(i,y){var S=n[y];return"$"+(Array.isArray(S)?S.join("$"):S)}))}if(typeof a=="function"){var p=this;return t[Symbol.replace].call(this,o,function(){var i=arguments;return typeof i[i.length-1]!="object"&&(i=[].slice.call(i)).push(s(i,p)),a.apply(this,i)})}return t[Symbol.replace].call(this,o,a)},M.apply(this,arguments)}function ir(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&k(t,e)}function k(t,e){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},k(t,e)}var v=t=>{switch(!0){case/assert/gi.test(t.constructor.name):case/expectation/gi.test(t.constructor.name):case(t.name&&/assert/gi.test(t.name)):case(t.message&&/assert/gi.test(t.message)):case(t.stack&&/@vitest\/expect/gi.test(t.stack)):case(t.stack&&/playwright\/lib\/matchers\/expect\.js/gi.test(t.stack)):case"matcherResult"in t:return u.FAILED;default:return u.BROKEN}},pr=function(){var{onlyFirst:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(r,e?void 0:"g")},z=t=>{var e=pr();return t.replace(e,"")},h=t=>{var{message:e,stack:r}=t;return{message:e?z(e):void 0,trace:r?z(r):void 0}},vt=M(/(?:^|\s)@?allure\.id[:=]([^\s]+)/,{id:1}),ur=new RegExp(vt,"g"),xt=M(/(?:^|\s)@?allure\.label\.([^:=\s]+)[:=]([^\s]+)/,{name:1,value:2}),cr=new RegExp(xt,"g");var B=t=>{var e=[];t.split(" ").forEach(s=>{var o,a=(o=s.match(vt))===null||o===void 0||(o=o.groups)===null||o===void 0?void 0:o.id;a&&e.push({name:c.ALLURE_ID,value:a});var n=s.match(xt),{name:p,value:i}=n?.groups||{};p&&i&&e?.push({name:p,value:i})});var r=t.replace(cr,"").replace(ur,"").trim();return{labels:e,cleanTitle:r}};var b=t=>!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function",W=function(e){var{maxDepth:r=0,maxLength:s=0,replacer:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return gr(typeof e=="object"?JSON.stringify(e,lr(r,o)):String(e),s)},lr=(t,e)=>{var r=[],s=function(a,n){if(typeof n!="object"||n===null)return n;for(;r.length>0&&!Object.is(r.at(-1),this);)r.pop();if(!(t&&r.length>=t||r.includes(n)))return r.push(n),n instanceof Map?dr(r,n):n instanceof Set?fr(r,n):n};return e?mr(e,s):s},mr=(t,e)=>function(r,s){return e.call(this,r,t.call(this,r,s))},dr=(t,e)=>Array.from(e).filter(r=>{var[s]=r;return!t.includes(s)}).map(r=>{var[s,o]=r;return[s,t.includes(o)?void 0:o]}),fr=(t,e)=>Array.from(e).map(r=>t.includes(r)?void 0:r),gr=(t,e)=>e&&t.length>e?"".concat(t.substring(0,e),"..."):t;function Tt(t,e,r,s,o,a,n){try{var p=t[a](n),i=p.value}catch(y){return void r(y)}p.done?e(i):Promise.resolve(i).then(s,o)}function f(t){return function(){var e=this,r=arguments;return new Promise(function(s,o){var a=t.apply(e,r);function n(i){Tt(a,s,o,n,p,"next",i)}function p(i){Tt(a,s,o,n,p,"throw",i)}n(void 0)})}}var K=class{attachment(){var e=this;return f(function*(){yield e.warning()})()}attachmentFromPath(){var e=this;return f(function*(){yield e.warning()})()}description(){var e=this;return f(function*(){yield e.warning()})()}descriptionHtml(){var e=this;return f(function*(){yield e.warning()})()}displayName(){var e=this;return f(function*(){yield e.warning()})()}historyId(){var e=this;return f(function*(){yield e.warning()})()}labels(){var e=this;return f(function*(){yield e.warning()})()}links(){var e=this;return f(function*(){yield e.warning()})()}parameter(){var e=this;return f(function*(){yield e.warning()})()}logStep(){var e=this;return f(function*(){yield e.warning()})()}step(e,r){var s=this;return f(function*(){return yield s.warning(),r()})()}stepDisplayName(){var e=this;return f(function*(){yield e.warning()})()}stepParameter(){var e=this;return f(function*(){yield e.warning()})()}testCaseId(){var e=this;return f(function*(){yield e.warning()})()}warning(){return f(function*(){console.log("no test runtime is found. Please check test framework configuration")})()}},T=new K;var Ct="allureTestRuntime",$=t=>{globalThis[Ct]=()=>t},V=()=>globalThis?.[Ct],Y=()=>{var t=V();if(t){var e;return(e=t())!==null&&e!==void 0?e:T}return T},q=()=>{var t=V();if(t){var e;return(e=t())!==null&&e!==void 0?e:T}if("_playwrightInstance"in globalThis)try{return(0,eval)("(() => import('allure-playwright/autoconfig'))()").then(()=>{var r,s;return(r=(s=V())===null||s===void 0?void 0:s())!==null&&r!==void 0?r:T})}catch(r){return console.log("can't execute allure-playwright/autoconfig",r),T}return T};var m=function(e){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];var a=q();return b(a)?a.then(n=>n[e](...s)):a[e](...s)},g=(t,e)=>m("labels",{name:t,value:e}),Et=function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return m("labels",...r)},w=(t,e,r)=>m("links",{url:t,type:r,name:e}),At=function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return m("links",...r)},bt=(t,e,r)=>m("parameter",t,e,r),Dt=t=>m("description",t),Pt=t=>m("descriptionHtml",t),Rt=t=>m("displayName",t),_t=t=>m("historyId",t),Mt=t=>m("testCaseId",t),kt=(t,e,r)=>{var s=typeof r=="string"?{contentType:r}:r;return m("attachment",t,e,s)},wt=(t,e,r)=>{var s=typeof r=="string"?{contentType:r}:r;return m("attachmentFromPath",t,e,s)},yr=()=>({displayName:t=>m("stepDisplayName",t),parameter:(t,e,r)=>m("stepParameter",t,e,r)}),It=(t,e,r)=>m("logStep",t,e,r),Ft=(t,e)=>m("step",t,()=>e(yr())),Lt=(t,e)=>w(t,e,A.ISSUE),Ot=(t,e)=>w(t,e,A.TMS),Ht=t=>g(c.ALLURE_ID,t),jt=t=>g(c.EPIC,t),Nt=t=>g(c.FEATURE,t),Ut=t=>g(c.STORY,t),Gt=t=>g(c.SUITE,t),zt=t=>g(c.PARENT_SUITE,t),Bt=t=>g(c.SUB_SUITE,t),Wt=t=>g(c.OWNER,t),Kt=t=>g(c.SEVERITY,t),Vt=t=>g(c.LAYER,t),$t=t=>g(c.TAG,t),Yt=function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return m("labels",...r.map(o=>({name:c.TAG,value:o})))};var qt={stepsFromCommands:{maxArgumentLength:128,maxArgumentDepth:3}},Jt=(t,e)=>{let r=t.findIndex(e);return r!==-1?J(t.splice(r)):[]},J=t=>{let e=t.length,r=new Array(e);for(let s=0;s<e;s++)r[e-s-1]=t[s];return r},Zt=t=>t[t.length-1],Xt=t=>typeof t<"u";var d=()=>{let t=Cypress.env("allure");return t||(t={config:qt,initialized:!1,messages:[],testPlan:void 0,currentTest:void 0,projectDir:void 0,stepStack:[],stepsToFinalize:[],nextApiStepId:0},Cypress.env("allure",t)),t},Qt=()=>d().initialized,te=()=>{d().initialized=!0},Z=()=>d().messages,ee=t=>{d().messages=t},l=t=>{Z().push(t)},re=()=>d().testPlan,se=()=>d().projectDir,oe=()=>d().currentTest,ne=t=>{d().currentTest=t},ae=()=>{d().currentTest=void 0},ie=()=>d().config,x=()=>d().stepStack,pe=()=>Zt(x()),I=t=>x().push(t);var Sr=t=>J(x().splice(t)),ue=()=>Sr(0);var F=(t,e)=>d().stepsToFinalize.push([t,e]),ce=()=>d().stepsToFinalize,le=()=>{let t=d();t.stepsToFinalize=[]};var me=(t,e)=>{let r=re();if(r){let s=de(t);for(let o of vr(e)){let a=xr(r,t,s,o.tests);Tr(o.tests,a)}}},vr=function*(t){let e=[];for(let r=t;r;r=e.pop()){yield r;for(let s=r.suites.length-1;s>=0;s--)e.push(r.suites[s])}},xr=(t,e,r,s)=>{let o=[];return s.forEach((a,n)=>{let{fullNameSuffix:p,labels:i}=X(e,a),y=`${r}#${p}`,S=i.find(({name:tr})=>tr===c.ALLURE_ID)?.value;Cr(t,y,S)||o.push(n)}),o},Tr=(t,e)=>{for(let r=e.length-1;r>=0;r--)t.splice(e[r],1)},Cr=(t,e,r)=>t.tests.some(s=>r&&s.id?.toString()===r||s.selector===e);var L="__allure_report_system_hook__",fe=()=>{Cypress.mocha.getRunner().on("start",Er).on("suite",Ar).on("suite end",xe).on("hook",br).on("hook end",Dr).on("test",Pr).on("pass",Te).on("fail",Rr).on("pending",Ce).on("test end",st)},ge=()=>{afterEach(L,ot),after(L,_r)},Er=()=>{he(),Se()},Ar=t=>{t.root&&me(Cypress.spec,t),ve(t)},br=t=>{C(t)||Q(t)},Dr=t=>{C(t)||O(t)},Pr=t=>{D(t)||tt(t)},Rr=(t,e)=>{let r="hookName"in t;if(r&&ye(t))return;r&&C(t)&&Q(t,Date.now()-(t.duration??0)),et(e),r&&rt(t,e)},_r=function(){ot(),E(this)};var Ee=Cypress.platform==="win32",Ae=t=>t.substring(t.lastIndexOf(Ee?"\\":"/")+1),de=t=>{let e=se(),r=e?t.absolute.substring(e.length+1):t.relative;return Ee?r.replaceAll("\\","/"):r},be=t=>Array.isArray(t)||t.buffer?btoa(String.fromCharCode.apply(null,t)):t,nt=t=>({...X(Cypress.spec,t),start:t.wallClockStartedAt?.getTime()||Date.now()}),De=t=>({duration:t.duration??0,retries:t._retries??0}),at=()=>({statusDetails:{message:"This is a pending test"}}),Pe=(t,e,r)=>{let s={id:t.id,stop:Date.now(),status:e??Fe(t)};return r&&(s.statusDetails=r),s},Re=Symbol("The test has been reported to Allure"),it=t=>{t[Re]=!0},D=t=>t[Re]===!0,Mr=function*(t){let e=[];for(let r=t;r;r=e.pop()){yield r;for(let s=r.suites.length-1;s>=0;s--)e.push(r.suites[s])}},_e=function*(t){for(let e of Mr(t))yield*e.tests},Me=t=>{let e=[];for(let r=t.parent;r;r=r.parent)e.push(r);return e.reverse(),e};var ke=()=>(d().nextApiStepId++).toString(),X=(t,e)=>{let r=e.title,{cleanTitle:s,labels:o}=B(r),n=`${[...e.titlePath().slice(0,-1),s].join(" ")}`;return{name:s,labels:o,fullNameSuffix:n}},C=t=>t.title.includes(L),ye=t=>t.parent.root&&t.hookName==="after all",we=t=>{let e=t.test;return t.test.parent.hooks.findLast(a=>a.hookName==="after all")?.hookId===e.hookId},Ie=(t,e,r,s)=>{let o=e?u.SKIPPED:v(r),{message:a,trace:n}=h(r);return{status:o,statusDetails:{message:e?kr(t,s):a,trace:n}}},kr=(t,e)=>{let r=e.title?`'${e.title}'`:"root";return`'${t}' defined in the ${r} suite has failed`};var P={},Le=t=>t.type==="api",R=t=>t.type==="log",pt=t=>N(wr(),t),wr=()=>{let t=ke();return I({id:t,type:"api"}),t},Oe=t=>{let e=v(t),r=h(t);Fr(e,r),je(t)},ut=(t,e)=>H(r=>Le(r),t,e),H=(t,e,r)=>He(Jt(x(),t),e,r),j=(t,e)=>He(ue(),t,e),ct=()=>{j(),ce().forEach(Ir),le()},Fe=t=>t.error?v(t.error):u.PASSED,Ir=([t,e])=>{let{id:r,error:s}=t,o={id:r};s&&(o.statusDetails=h(s)),e?.(o),l({type:"cypress_step_finalize",data:o})},Fr=(t,e)=>{let r=x(),s=r.at(r.findLastIndex(R)+1);s&&H(o=>Object.is(o,s),t,e)},Lr=(t,e)=>{if(R(t)){let r=t.log.attributes.error;if(r)return t.error=r}return e&&(t.error=e),t.error},He=(t,e,r)=>{let s;for(let o of t)s=Lr(o,s),Or(o,e,r);s&&je(s)},je=t=>x().forEach(e=>e.error=t),Or=(t,e,r)=>{Ne(t,e,r),Le(t)&&t.error&&F(t)};var he=()=>$(new lt),mt=()=>Y(),lt=class{constructor(){this.#e()}labels(...e){return this.#t({type:"metadata",data:{labels:e}})}links(...e){return this.#t({type:"metadata",data:{links:e}})}parameter(e,r,s){return this.#t({type:"metadata",data:{parameters:[{name:e,value:r,...s}]}})}description(e){return this.#t({type:"metadata",data:{description:e}})}descriptionHtml(e){return this.#t({type:"metadata",data:{descriptionHtml:e}})}displayName(e){return this.#t({type:"metadata",data:{displayName:e}})}historyId(e){return this.#t({type:"metadata",data:{historyId:e}})}testCaseId(e){return this.#t({type:"metadata",data:{testCaseId:e}})}attachment(e,r,s){let o=r?.type==="Buffer"?r.data:r,a=typeof o=="string"?"utf8":"base64",n=be(o);return this.#t({type:"attachment_content",data:{name:e,content:n,encoding:a,contentType:s.contentType,fileExtension:s.fileExtension}})}attachmentFromPath(e,r,s){return this.#t({type:"attachment_path",data:{name:e,path:r,contentType:s.contentType,fileExtension:s.fileExtension}})}logStep(e,r=u.PASSED,s){return cy.wrap(P,{log:!1}).then(()=>(pt(e),Cypress.Promise.resolve())).then(()=>(ut(r,s?h(s):void 0),Cypress.Promise.resolve()))}step(e,r){return cy.wrap(P,{log:!1}).then(()=>(pt(e),Cypress.Promise.resolve(r()))).then(s=>(ut(),s))}stepDisplayName(e){return this.#t({type:"step_metadata",data:{name:e}})}stepParameter(e,r,s){return this.#t({type:"step_metadata",data:{parameters:[{name:e,value:r,mode:s}]}})}flushAllureMessagesToTask(e){let r=this.#r();r.length&&cy.task(e,{absolutePath:Cypress.spec.absolute,messages:r},{log:!1})}flushAllureMessagesToTaskAsync(e){let r=this.#r();if(r.length){let s={absolutePath:Cypress.spec.absolute,messages:r,isInteractive:Cypress.config("isInteractive")};return cy.task(e,s,{log:!1})}}#e(){ee([])}#t(e){return l(e),Cypress.Promise.resolve()}#r(){let e=Z();return this.#e(),e}};var Se=()=>{l({type:"cypress_run_start",data:{}})},ve=t=>{l({type:"cypress_suite_start",data:{id:t.id,name:t.title,root:t.root,start:Date.now()}})},xe=t=>{l({type:"cypress_suite_end",data:{root:t.root,stop:Date.now()}})},Q=(t,e)=>{l({type:"cypress_hook_start",data:{name:t.title,scopeType:t.hookName.includes("each")?"each":"all",position:t.hookName.includes("before")?"before":"after",start:e??Date.now()}})},O=t=>{ct(),l({type:"cypress_hook_end",data:{duration:t.duration??0}})},tt=t=>{ne(t),l({type:"cypress_test_start",data:nt(t)}),it(t)},N=(t,e)=>{l({type:"cypress_step_start",data:{id:t,name:e,start:Date.now()}})},Ne=(t,e,r)=>{l({type:"cypress_step_stop",data:Pe(t,e,r)})},Te=()=>{l({type:"cypress_test_pass",data:{}})},et=t=>{let e=v(t),r=h(t);j(e,r),l({type:"cypress_fail",data:{status:e,statusDetails:r}})},rt=(t,e)=>{let r=t.hookName.includes("each"),s=t.parent,o=Ie(t.title,r,e,s);O(t),Hr(),jr(s,o)},Ce=t=>{D(t)?j(u.SKIPPED,{message:"The test was skipped before the command was completed"}):tt(t),l({type:"cypress_test_skip",data:at()})},st=t=>{ct(),l({type:"cypress_test_end",data:{duration:t.duration??0,retries:t._retries??0}}),ae()},Ue=(t,e)=>{l({type:"attachment_path",data:{path:t,name:e,contentType:_.PNG}})},E=t=>{if(we(t)){let e=t.test;return C(e)||O(e),Ge()}},dt=(t,e)=>{try{return et(e),rt(t.test,e),Ge()}catch(r){Ur(t,r)}},ft=(t,e)=>{if(!dt(t,e)?.then(()=>{throw e}))throw e},ot=()=>mt().flushAllureMessagesToTask("reportAllureCypressSpecMessages"),Ge=()=>mt().flushAllureMessagesToTaskAsync("reportFinalAllureCypressSpecMessages"),Hr=()=>{let t=oe();t&&st(t)},jr=(t,e)=>{for(let r of _e(t))D(r)||Nr(r,r.pending?{...at(),status:u.SKIPPED}:e)},Nr=(t,e)=>{l({type:"cypress_skipped_test",data:{...nt(t),...e,...De(t),suites:Me(t).map(r=>r.id)}}),it(t)},Ur=(t,e)=>{try{console.error(`Unexpected error when reporting the failure of ${t.test?.title??"'after all'"}`),console.error(e)}catch{}};var Be=()=>{let t=Gr();zr(t),Br(t)},Gr=()=>{let t=0;return{getSuiteDepth:()=>t,incrementSuiteDepth:()=>{t++},decrementSuiteDepth:()=>{t--}}},zr=({incrementSuiteDepth:t,decrementSuiteDepth:e})=>{let r=a=>(n,p,i)=>{t();try{return Wr(a,n,p,i)}finally{e()}},s=globalThis.describe,o=r(s);o.only=r(s.only),o.skip=r(s.skip),globalThis.describe=o},Br=({getSuiteDepth:t})=>{let e=globalThis.after,r=(s,o)=>typeof s=="string"?e(s,ze(t,o)):e(ze(t,s));globalThis.after=r},Wr=(t,...e)=>{let[r,s,o]=e;return typeof o>"u"&&typeof s>"u"?t(r):typeof s=="function"?t(r,s):t(r,s,o)},ze=(t,e)=>{if(t()===0&&e){let r=e.length?Kr(e):Vr(e);return Object.defineProperty(r,"name",{value:e.name}),r}return e},Kr=t=>function(e){let r=s=>{if(s){dt(this,s)?.then(()=>e(s))||e(s);return}try{if(E(this)?.then(()=>e()))return}catch(o){e(o);return}e()};return t.bind(this)(r)},Vr=t=>function(){let e,r;try{e=t.bind(this)()}catch(s){r=s}if(r)ft(this,r);else return b(e)?e.then(()=>E(this),s=>ft(this,s)):(E(this),e)};var We=t=>Yr(t)?Ke(t):W(t,$r()),$r=()=>{let{stepsFromCommands:{maxArgumentDepth:t,maxArgumentLength:e}}=ie();return{maxDepth:t,maxLength:e,nonNullReplacerWithDomSupport:qr}},Yr=t=>typeof t=="object"&&t!==null&&Cypress.dom.isDom(t),Ke=t=>Cypress.dom.stringify(t,"long"),qr=(t,e)=>{if(typeof e=="object"){if(e===null)return;if(Cypress.dom.isDom(e))return Ke(e)}return e};var Ve=t=>{let{event:e,instrument:r}=t.attributes;return!(r!=="command"||e||Xr(t))},$e=(t,e)=>{let r=pe();if(r&&R(r)){let{name:s,props:{name:o}}=r.log.attributes.consoleProps();s==="screenshot"&&o===t&&(r.attachmentName=e)}},Ye=t=>{let e=ns();typeof e<"u"&&as(e.log,t)&&U(e.log.attributes.id),Jr(t),N(t.attributes.id,Qr(t)),Zr(t)},U=t=>H(({id:e})=>e===t),Jr=t=>{let r={id:t.attributes.id,type:"log",log:t};I(r),F(r,s=>{s.parameters=ts(t),r.attachmentName&&(s.name=r.attachmentName)})},Zr=t=>{let{groupStart:e,end:r,id:s}=t.attributes;if(r)U(s);else if(e){let o=t.endGroup;t.endGroup=function(){return U(s),o.call(this)}}else{let o=t.end;t.end=function(){return U(s),o.call(this)}}},Xr=({attributes:{name:t,consoleProps:e}})=>t==="then"&&Object.is(e().props["Applied To"],P),Qr=t=>{let{name:e,message:r,displayName:s}=t.attributes,o=(s??e).trim(),a=(qe(t)??rs(t)??t.attributes.renderProps().message??r).trim();return[o,a].filter(Boolean).join(" ")},ts=t=>ss(t).map(([e,r])=>({name:e.toString(),value:We(r)})).filter(is(t)),es=["Given","When","Then","And"],rs=t=>{let{attributes:{name:e,message:r}}=t;if(es.includes(e.trim())&&r.startsWith("**")&&r.endsWith("**"))return r.substring(2,r.length-2)},ss=t=>{let{attributes:{consoleProps:e}}=t,r=!!qe(t);return Object.entries(e().props).filter(([s,o])=>Xt(o)&&!(r&&s==="Message"))},qe=t=>{if(os(t)){let e=t.attributes.consoleProps().props.Message;if(e&&typeof e=="string")return e}},os=({attributes:{name:t}})=>t==="assert",ns=()=>x().findLast(R),as=(t,e)=>{let{groupStart:r,type:s}=t.attributes,{type:o}=e.attributes;return!r&&(s==="child"||o!=="child")},is=t=>t.attributes.name==="wrap"?()=>!0:({name:e,value:r})=>e!=="Yielded"||r!=="{}";var Je=()=>Cypress.on("fail",Ze).on("log:added",us),gt=()=>Cypress.Screenshot.defaults({onAfterScreenshot:ps}),ps=(...[,{name:t,path:e}])=>{let r=t??Ae(e);Ue(e,r),$e(t,r)},us=(t,e)=>{Ve(e)&&Ye(e)},Ze=t=>{if(Oe(t),cs())throw t},cs=()=>Object.is(Cypress.listeners("fail").at(-1),Ze);var Xe=()=>{fe(),Je(),ge(),Be()};var Qe=()=>{Qt()||(te(),Xe(),gt())};Qe();
//# sourceMappingURL=index.js.map
